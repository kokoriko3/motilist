{% extends "layout.html" %}
{% block title %}å®¿æ³Šå…ˆé¸æŠ{% endblock %}
{% block content %}
<section class="stay-shell">
  {% set active_tab = 'stay' %}
  {% include 'plan/_plan_header_tabs.html' %}

  <div class="stay-body">
    <div class="banner error-banner" data-stay-error hidden>ã‚¨ãƒ©ãƒ¼ãŒèµ·ãã¾ã—ãŸ æ™‚é–“ã‚’ãŠã„ã¦å†åº¦å®Ÿè¡Œã—ã¦ãã ã•ã„</div>

    <div class="stay-toolbar">
      <div class="support-label">Supported by <span class="rkt">Rakuten Developers</span></div>
      <div class="stay-sort">
        <span class="sort-icon">ğŸ“¶</span>
        <button type="button" class="sort-button" data-sort-toggle>ä¸¦ã³æ›¿ãˆ</button>
        <div class="sort-menu" data-sort-menu hidden>
          <button type="button" data-sort="price-asc" {% if sort_key == 'price-asc' %}aria-current="true"{% endif %}>é‡‘é¡ æ˜‡é †</button>
          <button type="button" data-sort="price-desc" {% if sort_key == 'price-desc' %}aria-current="true"{% endif %}>é‡‘é¡ é™é †</button>
          <button type="button" data-sort="review-desc" {% if sort_key == 'review-desc' %}aria-current="true"{% endif %}>ãƒ¬ãƒ“ãƒ¥ãƒ¼é †</button>
        </div>
      </div>
    </div>

    <form action="{{ url_for('plan.stay_select') }}" method="post">
      <div class="stay-list" data-stay-list>
        {% for stay in stay_options %}
        <article
          class="stay-card {% if stay.is_selected %}selected{% endif %}"
          data-stay-id="{{ stay.id }}"
          data-price="{{ stay.price if stay.price is not none else "" }}"
          data-review="{{ stay.review if stay.review is not none else "" }}"
        >
          <label>
            <input
              type="radio"
              name="hotel_id"
              value="{{ stay.id }}"
              {% if stay.is_selected %}checked{% endif %}
            >
            <div class="stay-card__main">
              <p class="stay-name">{{ stay.name }}</p>
              <p class="stay-price">
                {% if stay.price is not none %}
                  {{ "{:,}".format(stay.price) }}å††ã€œ
                {% else %}
                  -
                {% endif %}
              </p>
              <p class="stay-address">{{ stay.address }}</p>
            </div>
            <div class="stay-card__meta">
              <span class="stay-stars">
                {% if stay.review is not none %}
                  {{ stay.review }}
                {% else %}
                  -
                {% endif %}
              </span>
              {% if stay.url %}
                <a class="stay-detail" href="{{ stay.url }}" target="_blank" rel="noopener">è©³ç´° â†—</a>
              {% endif %}
            </div>
            <div class="stay-card__thumb">
              {% if stay.image_url %}
                <img src="{{ stay.image_url }}" alt="{{ stay.name }}">
              {% else %}
                <div class="stay-card__thumb--placeholder">No image</div>
              {% endif %}
            </div>
          </label>
        </article>
        {% endfor %}
      </div>

      <div class="stay-footer">
        <button type="button" class="pill-ghost" data-stay-clear>é¸æŠã—ãªã„</button>
        <div class="pager" data-stay-pager>
          {% if total_pages > 1 %}
            {% for p in range(1, total_pages + 1) %}
              <button type="button" class="pager-btn {% if p == page %}pager-current{% endif %}" data-page="{{ p }}">{{ p }}</button>
            {% endfor %}
          {% endif %}
        </div>
        <button type="submit" class="cta-primary" data-stay-confirm>ç¢ºå®š</button>
      </div>
    </form>
  </div>
</section>
<script defer src="{{ url_for('static', filename='js/stay.js') }}"></script>
{% endblock %}