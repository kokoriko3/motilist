{% extends 'layout.html' %}

{% block title %}プランを編集 | {{ config['BRAND_NAME'] }}{% endblock %}

{% block content %}
  <section class="page-section travel-form">
    <div class="travel-form__header">
      <h1>プランを編集</h1>
      <span class="travel-form__note">入力内容はいつでも更新できます</span>
    </div>

    <form class="travel-form__body" aria-label="旅行プラン編集フォーム">
      <div class="travel-form__row">
        <label>
          <span>プランタイトル</span>
          <input type="text" placeholder="例: 家族で沖縄" value="{{ plan.title }}" />
        </label>
        <label>
          <span>行きたい場所</span>
          <input type="text" placeholder="例: 沖縄, 京都" value="{{ plan.destination }}" />
        </label>
      </div>

      <div class="travel-form__row travel-form__row--short">
        <label>
          <span>日数</span>
          <input type="text" placeholder="日間" value="{{ plan.duration }}" />
        </label>
        <label>
          <span>出発日</span>
          <input type="text" placeholder="MM/DD" value="{{ plan.start_date }}" />
        </label>
        <label>
          <span>人数</span>
          <input type="number" min="1" value="{{ plan.members }}" />
        </label>
      </div>

      <div class="travel-form__row">
        <label>
          <span>宿泊先</span>
          <input type="text" placeholder="ホテル名" value="{{ plan.accommodation }}" />
        </label>
        <label>
          <span>移動手段</span>
          <input type="text" placeholder="例: 飛行機, 新幹線" value="{{ plan.transport }}" />
        </label>
      </div>

      <div class="travel-form__row travel-form__row--chips" data-purpose>
        <label>
          <span>旅行の目的</span>
          <div class="purpose-add-row">
            <input type="text" data-purpose-input placeholder="例: グルメ, 観光" />
            <button class="purpose-add-button" type="button" data-purpose-add>追加</button>
          </div>
        </label>
        <div class="chip-group" data-purpose-list>
          {% for value in purpose_values %}
            <span class="chip is-selected" data-purpose-chip data-value="{{ value }}">
              <span class="chip__label">{{ value }}</span>
              <button class="chip__remove" type="button" aria-label="削除" data-purpose-remove>&times;</button>
            </span>
          {% endfor %}
        </div>
        <input type="hidden" name="purposes" data-purpose-hidden value="{{ purpose_values|join(',') }}" />
      </div>

      <div class="travel-form__row">
        <label>
          <span>メモ・詳細</span>
          <textarea rows="4" placeholder="スケジュールや希望などをメモ">{{ plan.summary }}</textarea>
        </label>
      </div>

      <div class="travel-form__row">
        <span>旅行に求めること</span>
        <div class="need-grid">
          {% for option in needs %}
            <label class="need-option">
              <input type="checkbox" {% if option == plan.tag %}checked{% endif %} />
              <span>{{ option }}</span>
            </label>
          {% endfor %}
        </div>
      </div>

      <div class="cta-row">
        <a class="cta-large" href="{{ url_for('plan_detail', plan_id=plan.id, source='own') }}">変更を保存する</a>
        <button class="cta-button ghost" type="button" onclick="window.location.href='{{ url_for('plan_detail', plan_id=plan.id, source='own') }}'">
          キャンセル
        </button>
      </div>
    </form>
  </section>
{% endblock %}
