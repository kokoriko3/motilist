{% extends "layout.html" %}
{% block title %}スケジュール一覧{% endblock %}
{% block content %}
<section class="schedule-shell">
  <div class="plan-header">
    <div>
      <p class="plan-title">福岡　2泊3日 <span class="icon-inline">✎</span></p>
    </div>
    <div class="plan-meta">
      <span class="plan-date">1月1日~1月3日</span>
      <button type="button" class="pill-button">共有</button>
      <button type="button" class="pill-button">保存</button>
    </div>
  </div>

  <div class="plan-tabs">
    <a href="{{ url_for('plan.plan_transit') }}">交通手段</a>
    <a href="{{ url_for('plan.stay_select') }}">宿泊場所</a>
    <a class="active">スケジュール</a>
    <a href="{{ url_for('plan.checklist_list') }}">持ち物</a>
  </div>

  <div class="schedule-body">
    <div class="panel-header">
      <div class="error-inline" data-schedule-error hidden>日程の取得に失敗しました</div>
      <a class="cta-primary small" href="{{ url_for('plan.schedule_edit') }}" name="edit">編集</a>
    </div>

    <div class="schedule-grid">
      <!-- 日付ナビゲーション -->
      <div class="day-nav" data-day-nav>
        {% for day in days %}
        <!-- loop.index == 1 を active に設定 (通常は1日目が初期表示) -->
        <!-- 【変更】day.id -> day.day -->
        <button type="button" class="day-pill {% if loop.index == 1 %}active{% endif %}" data-day-target="{{ day.day }}">
          {{ day.label }}
        </button>
        {% endfor %}
      </div>

      <!-- スケジュール詳細 -->
      <div class="schedule-table" data-day-container>
        <div class="schedule-header">
          <div class="col-time">時間</div>
          <div class="col-place">場所</div>
          <div class="col-note">補足</div>
        </div>
        
        {% for day in days %}
        <!-- 1日目以外は hidden クラスをつける -->
        <div class="schedule-rows {% if loop.index != 1 %}hidden{% endif %}" data-day="{{ day.day }}">
          
          <!-- 【変更】entries -> activities -->
          {% if day.activities|length == 0 %}
          <div class="schedule-empty">スケジュールが未登録です</div>
          {% else %}
          
          {% for activity in day.activities %}
          <div class="schedule-row">
            <div class="col-time">{{ activity.time }}</div>
            <!-- 【変更】place -> title -->
            <div class="col-place">{{ activity.title }}</div>
            <div class="col-note">{{ activity.note }}</div>
          </div>
          {% endfor %}
          
          {% endif %}
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>
<script defer src="{{ url_for('static', filename='js/schedule.js') }}"></script>
{% endblock %}
