{% extends 'layout.html' %}

{% block title %}å…¬é–‹ãƒ—ãƒ©ãƒ³ä¸€è¦§ | Mochi List{% endblock %}

{% block content %}
  <section class="page-section plan-public">
    <header class="plan-shelf__header">
      <h1>å…¬é–‹ ãƒ—ãƒ©ãƒ³ä¸€è¦§</h1>
      <div class="plan-shelf__actions">
        <form method="get" class="plan-search-form">
          <label class="plan-search">
            <span class="plan-search__icon">ğŸ”</span>
            <input type="search" name="q" placeholder="ä»–äººã®æ—…è¡Œãƒ—ãƒ©ãƒ³ã‚’æ¤œç´¢" value="{{ query }}" />
          </label>
        </form>
        <a class="plan-public__history" href="#">ä¿å­˜å±¥æ­´</a>
      </div>
    </header>

    {% if plans %}
      <div class="plan-tiles plan-tiles--public">
        {% for plan in plans %}
          {% with plan=plan, can_delete=False, detail_url=url_for('plan.plan_detail', template_id=plan.template_id, source='public') %}
            {% include 'components/_plan_card.html' %}
          {% endwith %}
        {% endfor %}
      </div>
      <nav class="plan-pagination" aria-label="ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³">
        <div class="plan-pagination__links">
          {% if page > 1 %}
            <a class="page-nav" href="{{ url_for('plan.public_plan_list', page=page-1, q=query) }}" aria-label="å‰ã®ãƒšãƒ¼ã‚¸">&lsaquo;</a>
          {% else %}
            <span class="page-nav is-disabled" aria-hidden="true">&lsaquo;</span>
          {% endif %}
          {% for page_number in pagination %}
            {% if page_number %}
              {% if page_number == page %}
                <span class="page-number is-current">{{ page_number }}</span>
              {% else %}
                <a class="page-number" href="{{ url_for('plan.public_plan_list', page=page_number, q=query) }}">{{ page_number }}</a>
              {% endif %}
            {% else %}
              <span class="page-ellipsis">&hellip;</span>
            {% endif %}
          {% endfor %}
          {% if page < total_pages %}
            <a class="page-nav" href="{{ url_for('plan.public_plan_list', page=page+1, q=query) }}" aria-label="æ¬¡ã®ãƒšãƒ¼ã‚¸">&rsaquo;</a>
          {% else %}
            <span class="page-nav is-disabled" aria-hidden="true">&rsaquo;</span>
          {% endif %}
        </div>
        <form class="plan-pagination__jump" method="get" action="{{ url_for('plan.public_plan_list') }}">
          {% if query %}
            <input type="hidden" name="q" value="{{ query }}" />
          {% endif %}
          <label for="public-page-jump">ãƒšãƒ¼ã‚¸</label>
          <input
            id="public-page-jump"
            type="number"
            name="page"
            min="1"
            max="{{ total_pages }}"
            value="{{ page }}"
            inputmode="numeric"
          />
          <button type="submit">è¡Œã</button>
        </form>
      </nav>
    {% else %}
      <p class="plan-public__empty">â€» è¡¨ç¤ºã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>
    {% endif %}
  </section>
{% endblock %}
